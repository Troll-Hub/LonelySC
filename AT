local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local Remote = ReplicatedStorage._BindableEvents.Moves.TakeDamage

-- Cache SOLO de nombres
local playerCache = {}

-- Actualiza cache
local function updateCache()
	table.clear(playerCache)
	for _, player in ipairs(Players:GetPlayers()) do
		table.insert(playerCache, player.Name)
	end
end

-- Inicial
updateCache()

Players.PlayerAdded:Connect(function(player)
	table.insert(playerCache, player.Name)
end)

Players.PlayerRemoving:Connect(function(player)
	for i, name in ipairs(playerCache) do
		if name == player.Name then
			table.remove(playerCache, i)
			break
		end
	end
end)

-- Loop principal: usa LOS NOMBRES del cache
task.spawn(function()
	while true do
		task.wait(1)

		for _, playerName in ipairs(playerCache) do
			local player = Players:FindFirstChild(playerName)
			if not player then continue end

			local character = player.Character
			if not character then continue end

			local humanoid = character:FindFirstChildOfClass("Humanoid")
			if humanoid then
				Remote:FireServer(humanoid, 10, player)
			end
		end
	end
end)
