local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- DuraciÃ³n editable (en segundos)
local timeDuration = 7  -- Â¡Cambia aquÃ­ si quieres mÃ¡s tiempo de dominio, papi! ðŸ•

-- Crear la ScreenGui principal
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TimeStopGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Frame draggable para el botÃ³n
local frame = Instance.new("Frame")
frame.Name = "TimeStopFrame"
frame.Size = UDim2.new(0, 180, 0, 70)
frame.Position = UDim2.new(0.5, -90, 0.5, -35)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
frame.BackgroundTransparency = 0.3
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 16)
corner.Parent = frame

-- BotÃ³n ZA WARUDO dorado
local button = Instance.new("TextButton")
button.Size = UDim2.new(1, -12, 1, -12)
button.Position = UDim2.new(0, 6, 0, 6)
button.BackgroundColor3 = Color3.fromRGB(255, 215, 0)
button.Text = "ðŸ•‘ ZA WARUDO"
button.TextColor3 = Color3.new(1,1,1)
button.TextScaled = true
button.Font = Enum.Font.Arcade
button.Parent = frame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 12)
btnCorner.Parent = button

-- Sonido Ã©pico Shadow DIO
local sound = Instance.new("Sound")
sound.SoundId = "rbxassetid://4786770367"
sound.Volume = 1
sound.Parent = button

-- Solo el contador de segundos (sin imagen ni nada extra)
local countdownFrame = Instance.new("Frame")
countdownFrame.Name = "CountdownOnly"
countdownFrame.Size = UDim2.new(0, 150, 0, 100)
countdownFrame.Position = UDim2.new(0, 20, 1, -120)
countdownFrame.BackgroundTransparency = 1
countdownFrame.Visible = false
countdownFrame.Parent = screenGui

local countdownText = Instance.new("TextLabel")
countdownText.Size = UDim2.new(1, 0, 1, 0)
countdownText.BackgroundTransparency = 1
countdownText.Text = tostring(timeDuration)
countdownText.TextColor3 = Color3.fromRGB(255, 215, 0)
countdownText.TextScaled = true
countdownText.Font = Enum.Font.GothamBlack
countdownText.TextStrokeTransparency = 0.6
countdownText.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
countdownText.Parent = countdownFrame

local stopEvent = ReplicatedStorage._BindableEvents.Moves.StopEnemy
local isRunning = false

-- Fade suave solo para el contador
local function fade(visible)
    local tweenInfo = TweenInfo.new(0.6, Enum.EasingStyle.Sine)
    TweenService:Create(countdownText, tweenInfo, {TextTransparency = visible and 0 or 1}):Play()
end

-- Aura amarilla brillante al cargar y respawn
local function addYellowAura(character)
    if not character then return end
    for _, child in pairs(character:GetChildren()) do
        if child:IsA("ParticleEmitter") and child.Name == "YellowAura" then
            child:Destroy()
        end
    end
    
    local torso = character:FindFirstChild("HumanoidRootPart") or character:FindFirstChild("Torso")
    if not torso then return end
    
    local aura = Instance.new("ParticleEmitter")
    aura.Name = "YellowAura"
    aura.Texture = "rbxassetid://243660364"
    aura.Color = ColorSequence.new(Color3.fromRGB(255, 255, 0), Color3.fromRGB(255, 200, 0))
    aura.Brightness = 3
    aura.Lifetime = NumberRange.new(1, 2)
    aura.Rate = 20
    aura.Speed = NumberRange.new(5, 10)
    aura.SpreadAngle = Vector2.new(360, 360)
    aura.Size = NumberSequence.new(1, 3)
    aura.Transparency = NumberSequence.new(0.5, 1)
    aura.Enabled = true
    aura.Parent = torso
end

addYellowAura(player.Character)
player.CharacterAdded:Connect(addYellowAura)

button.Activated:Connect(function()
    if isRunning then return end
    isRunning = true
    
    sound:Play()
    
    local char = player.Character
    if not (char and char:FindFirstChild("HumanoidRootPart")) then
        isRunning = false
        return
    end
    
    local centerPos = char.HumanoidRootPart.Position
    
    countdownFrame.Visible = true
    fade(true)
    
    local targets = {}
    for _, descendant in pairs(workspace:GetDescendants()) do
        if descendant:IsA("Humanoid") and descendant.Health > 0 then
            local model = descendant.Parent
            if model and model:FindFirstChild("HumanoidRootPart") and model ~= char then
                local hrp = model.HumanoidRootPart
                if (hrp.Position - centerPos).Magnitude <= 300 then
                    table.insert(targets, model)
                end
            end
        end
    end
    
    print("ðŸ• ZA WARUDO! " .. #targets .. " atrapados en " .. timeDuration .. " seg ðŸ”¥")
    
    coroutine.wrap(function()
        for i = timeDuration, 1, -1 do
            countdownText.Text = tostring(i)
            for _, target in pairs(targets) do
                if target.Parent and target:FindFirstChild("HumanoidRootPart") then
                    local args = {
                        [1] = true,
                        [2] = target,
                        [3] = target.HumanoidRootPart.CFrame
                    }
                    stopEvent:FireServer(unpack(args))
                end
            end
            task.wait(1)
        end
        
        -- Descongelar
        for _, target in pairs(targets) do
            if target.Parent and target:FindFirstChild("HumanoidRootPart") then
                local args = {
                    [1] = false,
                    [2] = target,
                    [3] = target.HumanoidRootPart.CFrame
                }
                stopEvent:FireServer(unpack(args))
            end
        end
        
        fade(false)
        task.delay(0.7, function()
            countdownFrame.Visible = false
            countdownText.Text = tostring(timeDuration)
        end)
        
        isRunning = false
        print("â° Tiempo restaurado, mi rey~ ðŸ˜˜ðŸ’‹")
    end)()
end)
