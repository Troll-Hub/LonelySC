-- Divine UI - Versi贸n VISUAL MEJORADA (Textos grandes y claros) - Conexi贸n por PIN

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local pin = ""
local dataChannel
local messages = {}

-- UI Principal: Divine UI (m谩s visible)
local gui = Instance.new("ScreenGui")
gui.Parent = game.CoreGui
gui.Name = "DivineUI"
gui.IgnoreGuiInset = true

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0.5, 0, 0.7, 0)
mainFrame.Position = UDim2.new(0.25, 0, 0.15, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 35)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = gui
mainFrame.Active = true
mainFrame.Draggable = true

-- Drag touch-friendly (igual que antes)
local dragging, dragInput, dragStart, startPos
local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)

mainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input == dragInput then update(input) end
end)

-- TTULO GRANDE Y BRILLANTE
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0.1, 0)
title.Text = "DIVINE UI"
title.BackgroundColor3 = Color3.fromRGB(80, 0, 150)
title.TextColor3 = Color3.new(1, 0.9, 0.2)
title.Font = Enum.Font.GothamBlack
title.TextSize = 32  -- 隆Grande y visible!
title.TextStrokeTransparency = 0.8
title.TextStrokeColor3 = Color3.new(0,0,0)
title.Parent = mainFrame

-- PIN - Texto grande y claro
local pinLabel = Instance.new("TextLabel")
pinLabel.Size = UDim2.new(0.5, 0, 0.08, 0)
pinLabel.Position = UDim2.new(0.05, 0, 0.12, 0)
pinLabel.Text = "PIN (4 d铆gitos):"
pinLabel.BackgroundTransparency = 1
pinLabel.TextColor3 = Color3.new(1,1,1)
pinLabel.Font = Enum.Font.GothamBold
pinLabel.TextSize = 24  -- M谩s grande
pinLabel.Parent = mainFrame

local pinBox = Instance.new("TextBox")
pinBox.Size = UDim2.new(0.45, 0, 0.08, 0)
pinBox.Position = UDim2.new(0.5, 0, 0.12, 0)
pinBox.Text = "1234"
pinBox.PlaceholderText = "Ej: 1234"
pinBox.TextSize = 26
pinBox.Font = Enum.Font.GothamSemibold
pinBox.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
pinBox.TextColor3 = Color3.new(1, 0.8, 0)
pinBox.Parent = mainFrame

-- Bot贸n Conectar - Grande y llamativo
local connectButton = Instance.new("TextButton")
connectButton.Size = UDim2.new(0.9, 0, 0.1, 0)
connectButton.Position = UDim2.new(0.05, 0, 0.22, 0)
connectButton.Text = "CONECTAR CON PIN"
connectButton.BackgroundColor3 = Color3.fromRGB(0, 180, 255)
connectButton.TextColor3 = Color3.new(1,1,1)
connectButton.Font = Enum.Font.GothamBold
connectButton.TextSize = 28
connectButton.Parent = mainFrame

-- Executor Remoto - Secci贸n clara
local execLabel = Instance.new("TextLabel")
execLabel.Size = UDim2.new(0.9, 0, 0.06, 0)
execLabel.Position = UDim2.new(0.05, 0, 0.34, 0)
execLabel.Text = "EJECUTOR REMOTO"
execLabel.BackgroundTransparency = 1
execLabel.TextColor3 = Color3.new(1, 0.5, 0.5)
execLabel.Font = Enum.Font.GothamBold
execLabel.TextSize = 24
execLabel.Parent = mainFrame

local codeBox = Instance.new("TextBox")
codeBox.Size = UDim2.new(0.9, 0, 0.22, 0)
codeBox.Position = UDim2.new(0.05, 0, 0.41, 0)
codeBox.MultiLine = true
codeBox.ClearTextOnFocus = false
codeBox.Text = "-- Escribe c贸digo Lua para el otro"
codeBox.TextSize = 20
codeBox.Font = Enum.Font.Code
codeBox.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
codeBox.TextColor3 = Color3.new(0.8, 1, 0.8)
codeBox.Parent = mainFrame

local execBtn = Instance.new("TextButton")
execBtn.Size = UDim2.new(0.45, 0, 0.08, 0)
execBtn.Position = UDim2.new(0.05, 0, 0.64, 0)
execBtn.Text = "EJECUTAR EN EL OTRO"
execBtn.BackgroundColor3 = Color3.fromRGB(220, 0, 0)
execBtn.TextColor3 = Color3.new(1,1,1)
execBtn.Font = Enum.Font.GothamBold
execBtn.TextSize = 22
execBtn.Parent = mainFrame

local clearBtn = Instance.new("TextButton")
clearBtn.Size = UDim2.new(0.45, 0, 0.08, 0)
clearBtn.Position = UDim2.new(0.5, 0, 0.64, 0)
clearBtn.Text = "BORRAR"
clearBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
clearBtn.TextColor3 = Color3.new(1,1,1)
clearBtn.Font = Enum.Font.GothamBold
clearBtn.TextSize = 22
clearBtn.Parent = mainFrame

-- Chat Directo - Secci贸n visible
local chatLabel = Instance.new("TextLabel")
chatLabel.Size = UDim2.new(0.9, 0, 0.06, 0)
chatLabel.Position = UDim2.new(0.05, 0, 0.74, 0)
chatLabel.Text = "CHAT DIRECTO"
chatLabel.BackgroundTransparency = 1
chatLabel.TextColor3 = Color3.new(0.5, 1, 0.5)
chatLabel.Font = Enum.Font.GothamBold
chatLabel.TextSize = 24
chatLabel.Parent = mainFrame

local chatScroll = Instance.new("ScrollingFrame")
chatScroll.Size = UDim2.new(0.9, 0, 0.18, 0)
chatScroll.Position = UDim2.new(0.05, 0, 0.81, 0)
chatScroll.BackgroundTransparency = 1
chatScroll.CanvasSize = UDim2.new(0,0,0,0)
chatScroll.Parent = mainFrame

local msgInput = Instance.new("TextBox")
msgInput.Size = UDim2.new(0.7, 0, 0.07, 0)
msgInput.Position = UDim2.new(0.05, 0, 0.92, 0)
msgInput.Text = ""
msgInput.PlaceholderText = "Escribe tu mensaje..."
msgInput.TextSize = 22
msgInput.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
msgInput.TextColor3 = Color3.new(1,1,1)
msgInput.Parent = mainFrame

local sendBtn = Instance.new("TextButton")
sendBtn.Size = UDim2.new(0.2, 0, 0.07, 0)
sendBtn.Position = UDim2.new(0.75, 0, 0.92, 0)
sendBtn.Text = "MANDAR"
sendBtn.BackgroundColor3 = Color3.fromRGB(0, 220, 0)
sendBtn.TextColor3 = Color3.new(1,1,1)
sendBtn.Font = Enum.Font.GothamBold
sendBtn.TextSize = 22
sendBtn.Parent = mainFrame

-- Conexi贸n con PIN (mismo relay simple)
local WS_URL = "wss://divine-chat-relay.glitch.me"

local function connectWithPin()
    pin = pinBox.Text
    if #pin ~= 4 then
        print("隆PIN debe ser 4 d铆gitos, papi! ")
        return
    end

    local ws = WebSocket.connect(WS_URL)

    ws.OnOpen:Connect(function()
        ws:Send(HttpService:JSONEncode({type = "join", pin = pin, name = player.Name}))
        print("隆CONECTADO AL PIN " .. pin .. "!  Listo para jugar")
    end)

    ws.OnMessage:Connect(function(raw)
        local data = HttpService:JSONDecode(raw)
        if data.type == "message" then
            addMessage("[Otro]: " .. data.text)
        elseif data.type == "execute" then
            pcall(function()
                loadstring(data.code)()
                print("隆CDIGO EJECUTADO DESDE EL OTRO! ")
            end)
        end
    end)

    local function send(type, payload)
        if ws then
            ws:Send(HttpService:JSONEncode({type = type, pin = pin, payload = payload}))
        end
    end

    execBtn.MouseButton1Click:Connect(function()
        send("execute", codeBox.Text)
    end)

    clearBtn.MouseButton1Click:Connect(function()
        codeBox.Text = ""
    end)

    sendBtn.MouseButton1Click:Connect(function()
        if msgInput.Text ~= "" then
            send("message", msgInput.Text)
            addMessage("[Yo]: " .. msgInput.Text)
            msgInput.Text = ""
        end
    end)
end

connectButton.MouseButton1Click:Connect(connectWithPin)

function addMessage(text)
    table.insert(messages, text)
    local lbl = Instance.new("TextLabel")
    lbl.Size = UDim2.new(1, 0, 0, 30)
    lbl.Text = text
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1
    lbl.TextSize = 20
    lbl.TextXAlignment = Enum.TextXAlignment.Left
    lbl.Parent = chatScroll
    chatScroll.CanvasSize = UDim2.new(0,0,0,#messages*32)
end

print("=== DIVINE UI CARGADA!  Escribe tu PIN y toca 'CONECTAR CON PIN' ===")
